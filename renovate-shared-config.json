{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    // Base configuration
    "config:recommended",
    // Add "Signed-off-by" footer to commit messages
    ":gitSignOff",
    // Catch-all for grouping dependencies not caught by other groups
    "group:all",
    ":preserveSemverRanges"
  ],
  // Clone git submodules when analyzing repositories
  //
  // Some repositories use git submodules for vendored dependencies that are
  // referenced in Cargo.toml files. Without initializing submodules, Renovate
  // will fail to analyze these dependencies.
  "cloneSubmodules": true,
  // Rebase when there are merge conflicts
  //
  // The "conflicted" option is typically the ideal choice for most situations
  // where you don't want to burn CI credits, while still keeping your branch
  // in a mergeable state at all times.
  "rebaseWhen": "conflicted",
  "customManagers": [
    {
      "customType": "regex",
      "managerFilePatterns": ["(^|/)Containerfile$", "(^|/)Dockerfile$"],
      "matchStrings": [
        "# renovate: datasource=(?<datasource>[a-z-]+) depName=(?<depName>[^\\s]+)\\s+ARG \\w+version=(?<currentValue>.+)"
      ]
    }
  ],
  "packageRules": [
    {
    // These files in these repos are synced from the bootc-dev/infra repository, which
    // sends PRs to update them. Ignoring them here to avoid conflicting Renovate updates.
      "matchRepositories": [
        "bootc-dev/bootc",
        "bootc-dev/bcvk",
        "bootc-dev/ci-sandbox",
        "bootc-dev/containers-image-proxy-rs",
        "bootc-dev/bootc-dev.github.io"
      ],
      "ignorePaths": [
        ".github/workflows/rebase.yml",
        ".github/workflows/openssf-scorecard.yml",
        ".github/actions/bootc-ubuntu-setup/action.yml",
        ".github/actions/setup-rust/action.yml"
      ]
    },
    // Group GitHub Actions dependencies
    {
      "description": ["GitHub Actions dependencies"],
      "matchManagers": [
        "github-actions"
      ],
      "groupName": "GitHub Actions",
      "enabled": true
    },
    // Group Rust dependencies
    {
      "description": ["Rust dependencies"],
      "matchManagers": [
        "cargo"
      ],
      "groupName": "Rust",
      "enabled": true
    },
    // Group Docker dependencies
    {
      "description": ["Docker dependencies"],
      "matchManagers": [
        "dockerfile",
        "custom.regex"
      ],
      "groupName": "Docker",
      "enabled": true
    },
    // Disable Containerfile digest pinning
    {
      "description": ["Containerfile digest pinning"],
      "matchManagers": [
        "dockerfile"
      ],
      "pinDigests": false
    },
    // Disable Fedora OCI updates
    //
    // This is due to there not being an easy way to tell Renovate which
    // Fedora version is "stable" and which has not been released yet.
    {
      "description": ["Disable Fedora OCI updates"],
      "matchManagers": [
        "dockerfile",
        "github-actions"
      ],
      "matchDepNames": [
        "quay.io/fedora/fedora",
        "quay.io/fedora/fedora-bootc"
      ],
      "enabled": false
    },
    // Ignore bootc cargo dependencies to fix failing Renovate task
    // See: https://github.com/bootc-dev/infra/actions/runs/19914695687
    {
      "matchManagers": ["cargo"],
      "matchPackageNames": [
        "composefs",
        "composefs-boot",
        "composefs-oci"
      ],
      "enabled": false
    }
  ]
}
